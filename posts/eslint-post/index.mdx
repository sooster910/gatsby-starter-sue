---
title: 정적 분석 툴 eslint, prettier
slug: eslint-post
author: Hyunsu Joo
published: 2021-10-10
lastUpdated: 2021-10-15
draft: false
image: ./cool-background.png
imageAlt: robot
tags: ['ESLint']
---

참고자료
[Eric Elliott]("https://medium.com/javascript-scene/streamline-code-reviews-with-eslint-prettier-6fb817a6b51d")

elsint와 prettier를 동시에 사용할 때 중복되는 부분에 대해
extends all of the formatting rules and it turns it off

eslint 는 오직 code quality 이슈에만 집중하도록 한다.
프리티어는 코드포맷팅에 집중하도록한다.

## Prettier

prettier 가 설치 되어 있는지 확인

```shell
npm list -g prettier

```

설치 되어 있지 않았으면, prettier를 설치해준다.

**global**

```shell
npm i -g prettier
```

**local dev dependency**

```shell
npm i prettier -D
```

prettier cli 옵션을 위한 설정을 알려준다.
prettier --[option] [file]

```shell
prettier
```

prettier는 따로 지정된 외부 파일 configuration 이 없어도 빌트인된 설정을 사용하여
어느정도의 기본 포맷팅은 가능하다.

예를 들어, 세미콜론 앞에 공백이 있을때,

### `prettier <파일>`

포맷팅을 적용한 결과 cmd창으로 보여준다.

```shell
prettier ./src/pages/index.js
```

### `prettier --write <파일>`

실제 코드에 적용된 룰에 따라 포매팅을 하여 overwrite 해준다.
세미콜론 앞의 공백이 사라짐을 알 수 있다.

### 커스텀으로 formatting 적용하기

커스텀으로 스타일 룰이 있는 파일은 .prettierrc 파일과 .config파일이 있다.

`.prettierrc`

```json
{
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "semi": false,
  "singleQuote": true,
  "trailingComma": false,
  "bracketSpacing": false,
  "jsxBracketSameLine": false
}
```

prettier가 ast 와 매번 같게 할 순 없지만

{% hint style="info" %}
webstorm IDE를 이용하는 경우, 이 설정들을 현재 프로젝트에 기본 코드 스타일로
설정할지에 대한 작은 문구창이 화면 상단에 뜨는데 Yes로 해준다. 만약 설정이 처음이 아니라면
묻는 문구가 뜨지 않을 수도 있는데 바뀐 룰을 프로젝트 내에 적용하기위해선,
.prettierrc 파일 내에서 마우스 오른쪽-> `Apply Prettier Code Stytle Rule`
로 적용한다.
{% endhint %}

IDE에서 prettier만 적용했을 때 rule 룰에 위배되는 코드들에 highlighting
이 되지 않는 것을 볼 수 있는데, ESLint 를 설정함으로써 코드 포맷에 대한 highlighting 이 되는 것을 볼 수 있다.

`printWidth` : esLint 에도 printWidth 가 있긴 하지만,
--fix 가 적용되지 않기때문에, prettier에서 적용해주었다.

### Webstorm에서 save시 auto formatting 적용

상단 메뉴에서 WebStorm->Preferences

prettier package 경로를 지정해주고, on Save 버튼을 누르면 매 save시
prettier 포맷팅이 현재 파일에 자동으로 적용된다.
{% hint style="info" %}
webstorm 에서 `.prettierrc` 에서 룰을 바꾼 후 자동저장되는 것을 확인 할 때 보이는 화면에서 바로 변경되지 않는다.
저장한 파일에서 소스 코드에 변경을 한번주고 save를 해야 포맷팅이 적용된 파일을 볼 수 있다.
{% endhint %}

## ESLint

### ESLint dependency 설치

```shell

 npm i eslint -D

```

### ESLint 초기 설정

prettier처럼 설정 룰은 eslint에서 제공하는 cli를 통해서 만들 수 있다.

```shell
 npx eslint --init
```

## ESLiint와 Prettier에서 룰이 겹치면 충돌하지 않을까?

ESLint에선 와 Prettier에서 겹치는 부분이 있다.  
ESLint 에선 Missing Semicolon에 에러를 내주고 있고

`.prettierrc` 에선
세미 콜론을 허용치 않겠단 것과 충돌하게된다.
prettier의 자동 수정 설정을 해놓았다면 매 파일 저장시 prettier의 설정에 의해
세미 콜론이 지워지고, 세미콜론이 지워진 자리엔 ESLint가 기다렸다는 듯이 에러 문구를 내준다.

### eslint-config-prettier

필요하지 않거나 Prettier 와 충돌할 수 있는 모든 규칙을 off 한다.
이를 통해 Prettier를 사용할 때 스타일 선택에 방해가 되지 않고 좋아하는 공유 가능한 구성을 사용할 수 있습니다.
이 구성 은 규칙만 해제 하므로 다른 구성과 함께 사용하는 것이 효과적이다..

### ✔️ eslint-config-prettier 설치

```shell

npm i -D eslint-config-prettier

```

`.eslintrc` - "extends":["prettier"] 를 추가해준다.

```json
{
  "extends": ["prettier"]
}
```

extends와 plugin의 차이로는 eslint 입장에서 config가 있다는 것을 예상하고
extends 의 속성을 감지하고, plugin은 plugin이 설치 되어 있다는 것을 예상한다.

다시 코드를 확인해보면 아까전의 eslint 에서 오류로 인지 되었던 `no-extra-semi`
규칙에 더이상 위배되지 않는다는 것을 볼 수 있다. 좀 더 정확하게 보자면
cli 로 `eslint <파일경로/파일명>` 실행 했을 때도 더이상 no-extra-semi 에 대한
규칙을 위배한 error log 를 볼 수 없다.

위에서 언급했듯이 prettier 와 충돌할 가능성이 있는 규칙들에 대해선 off 를 한다.
off 한 규칙들을 찾아보자면,
`node_modules/eslint-config-prettier/index.js` 를 확인해보면,

`no-extra-semi` 가 off 된 것을 알 수 있으며, IDE에서 prettier를 auto-fix로 설정 해 두었을 땐,
prettier와 eslint와의 충돌 없이, 포맷에 관련된 것이라면 prettier의 룰에 맞춰 자동고침이 된다.

주의할 점은 .eslintrc rule 에서 작성한 것은 eslint-config-prettier 의 rule을
overwrite 하기 때문에, prettier와 충돌이 생겨버린다.
가령 .prettierc 에선 `"singleQuote": false`,
.eslintrc 에선

```json
  "rules": {
      "quotes": [
            "error",
            "single"
        ]
  }
```

라고 한다면, ide에선 prettier가 " " 로 자동고침을 하고나면,
eslint에서 붉은색 줄의 오류를 나타내는 일이 생겨버린다.

eslint-config-prettier 의 목적은 코드의 품질과, 코드의 포맷을 분리하자의 취지 로써,
코드의 포맷을 담당하는 룰은 prettier가 모두 담당하게 하는 것이므로, eslint에서 정말 필요로 할 때를 제외하고는 prettier가 담당하는 것을 overwrite
할 필욘 없지 안을까 한다.

### eslint-plugin-prettier

ESLint가 프리티어의 형식에 맞추어 린팅하도록 세팅하는것이다.
eslint 만 돌려도 프리티어 까지 같이 확장해주는 기능이다.

### 패키지 설치

```shell
npm i -D eslint-plugin-prettier
```

_prettier_ 가 설치되어있단 가정하에 eslint-plugin-prettier 를 설치한다.

만약 eslint-config-prettier 없이 eslint-plugin-prettier를 사용할 경우,
.eslintrc 설정을 이렇게 한다.

```json
{
  "plugins": ["prettier"],
  "rules": {
    "prettier/prettier": "error"
  }
}
```

eslint-config-prettier와 함게 사용하는 경우,

```json
{
  "extends": ["plugin:prettier/recommended"]
}
```

만 설정해준다.
여기서 주의 할 점은 extends내에 여러 요소들이 있다면 다른 구성을 무시할 수 있도록 마지막 에 넣어야 합니다 .

`plugin:prettier/recommended`는 이 설정들이 다 포함되어 있다.

```json
{
  "extends": ["prettier"],
  "plugins": ["prettier"],
  "rules": {
    "prettier/prettier": "error",
    "arrow-body-style": "off",
    "prefer-arrow-callback": "off"
  }
}
```

"extends": ["prettier"] enables the config from eslint-config-prettier, which turns off some ESLint rules that conflict with Prettier.
"plugins": ["prettier"] registers this plugin.
"prettier/prettier": "error" turns on the rule provided by this plugin, which runs Prettier from within ESLint.
"arrow-body-style": "off" and "prefer-arrow-callback": "off" turns off two ESLint core rules that unfortunately are problematic with this plugin – see the next section.

eslint-config-prettier 에서 prettier의 semi:false 설정이 내부적으로 "prettier/prettier": "error"
의 설정에 의해 eslint 에서 오류를 감지할 때 prettier의 룰까지 expand하여 낸다.

이런 설정은 prettier , prettier --write cli로 고치거나 체킹할 필요없이
eslint-plugin-prettier를 사용해 prettier를 ESLint의 규칙으로 설정해두면,
--fix 옵션을 걸고 ESLint를 실행할때 린트 에러 뿐 아니라
prettier 에러까지 수정해주기 때문에 자동으로 포매팅이 된다.
